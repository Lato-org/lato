<%

user ||= Lato::User.new

%>

<%= turbo_frame_tag 'authentication_form-authentication-method' do %>
  <%= form_with url: lato.authentication_authentication_method_action_path, method: :post, data: { turbo_frame: '_self' } do |form| %>
    <%= lato_form_notices class: %w[mb-3] %>
    <%= lato_form_errors user, class: %w[mb-3] %>

    <div class="mb-4 text-center">
      <p><%= I18n.t('lato.authentication_method_help', email: h(user.email_protected)) %></p>
    </div>
    
    <% if user.authenticator_enabled? %>
      <div class="mb-3">
        <%= form.button I18n.t('lato.use_google_authenticator'), 
          type: 'submit', 
          name: 'method', 
          value: 'authenticator',
          class: 'btn btn-primary w-100' %>
      </div>
    <% end %>

    <% if user.webauthn_enabled? %>
      <div class="mb-3">
        <%= form.button I18n.t('lato.use_webauthn'), 
          type: 'submit', 
          name: 'method', 
          value: 'webauthn',
          class: 'btn btn-primary w-100' %>
      </div>
    <% end %>

    <div class="text-center mt-3 mb-3">
      <%= I18n.t('lato.or').downcase %> <%= link_to I18n.t('lato.reset_password').downcase, lato.authentication_recover_password_path %>
    </div>
  <% end %>
<% end %>
